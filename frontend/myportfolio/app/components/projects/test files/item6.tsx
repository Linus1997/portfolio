import { animate, motion, MotionValue, useMotionValue, useTransform } from "framer-motion";
import testdata from "../../../utils/testdata.json";
import ProjectCard from "../ProjectCard";
import { interpolate } from "flubber" // ES6

import { useEffect, useState } from "react";

export const getIndex = (_: any, index: number) => index;

export function useFlubber(progress: MotionValue<number>, paths: string[]) {
  return useTransform(progress, paths.map(getIndex), paths, {
    mixer: (a, b) => interpolate(a, b, { maxSegmentLength: 0.1 })
  });
}
const colors = [
  "#00cc88",
  "#0099ff",
  "#8855ff",
  "#ff0055",
  "#ee4444",
  "#ffcc00",
  
];

const paths = [
  "m 11.275604,-0.03058696 c -3.1030032,-0.0052532 -7.3537507,0.001153 -8.6292756,8.8747e-4 -0.2066602,-4.302e-5 -0.497914,0.11167213 -0.6507468,0.25070794 L 0.49122896,1.5894745 A 1.5053001,1.5042434 0 0 0 -6.0423249e-4,2.7019079 V 22.029938 A 0.66526159,0.6647946 0 0 0 0.66479103,22.694648 H 22.06131 a 0.6652616,0.66479461 0 0 0 0.665396,-0.66471 V 2.7019079 A 1.5053002,1.5042435 0 0 0 22.234872,1.5894745 L 20.73052,0.22100845 c -0.152815,-0.13901981 -0.444092,-0.25164344 -0.650747,-0.25159541 -3.202078,7.4432e-4 -5.168303,0.0060056 -8.629275,0 -0.04823,-8.369e-5 -0.126664,8.165e-5 -0.174894,0 z",
  "M 12.338887,-0.02742734 H 2.1729 A 2.1729,2.1729 135 0 0 0,2.1454727 v 9.2106363 7.33039 a 2.0736569,2.0736569 73.161365 0 0 0.3480132,1.149873 l 1.5783466,2.368665 A 1.1698524,1.1698524 28.110153 0 0 2.901972,22.726188 L 9.9437404,22.7136 22.74373,22.72731 V 4.0133833 A 2.0736567,2.0736567 73.161363 0 0 22.395717,2.8635108 L 20.81737,0.49484515 a 1.1723667,1.1723667 28.161363 0 0 -0.975613,-0.52227249 z",
  "M 12.338887,-0.02742734 3.5806722,-0.03613599 A 1.9562302,1.9562302 160.92051 0 0 2.3685498,0.38311321 L 0.53332274,1.8281222 A 1.398429,1.398429 115.89202 0 0 0,2.9268464 V 11.356109 22.72731 L 9.9437404,22.7136 21.651031,22.72614 A 1.0915302,1.0915302 135.03068 0 0 22.74373,21.63461 V 1.0652727 a 1.0927,1.0927 45 0 0 -1.0927,-1.09270004 z",
  "m 11.275604,-0.03058696 c -3.1030032,-0.0052532 -7.3537507,0.001153 -8.6292756,8.8747e-4 -0.2066602,-4.302e-5 -0.497914,0.11167213 -0.6507468,0.25070794 L 0.49122896,1.5894745 A 1.5053001,1.5042434 0 0 0 -6.0423249e-4,2.7019079 V 22.029938 A 0.66526159,0.6647946 0 0 0 0.66479103,22.694648 H 22.06131 a 0.6652616,0.66479461 0 0 0 0.665396,-0.66471 V 2.7019079 A 1.5053002,1.5042435 0 0 0 22.234872,1.5894745 L 20.73052,0.22100845 c -0.152815,-0.13901981 -0.444092,-0.25164344 -0.650747,-0.25159541 -3.202078,7.4432e-4 -5.168303,0.0060056 -8.629275,0 -0.04823,-8.369e-5 -0.126664,8.165e-5 -0.174894,0 z",
  "M 12.338887,-0.02742734 H 1.0926917 A 1.0926917,1.0926917 135 0 0 0,1.0652644 V 11.356109 21.63461 a 1.0911945,1.0911945 44.960502 0 0 1.092699,1.091193 L 9.9437404,22.7136 22.74373,22.72731 V 2.9268857 A 1.3949288,1.3949288 64.050222 0 0 22.209531,1.8291741 L 20.375925,0.39142074 a 1.9657792,1.9657792 19.050222 0 0 -1.212968,-0.41884808 z",
  "m 12.338887,-0.02742734 -8.2997275,0 A 1.5159345,1.5159345 157.51034 0 0 2.9676191,0.4161926 L 0.44394044,2.9380493 A 1.514387,1.514387 112.51034 0 0 0,4.0092692 V 11.356109 22.172 c -3.1795805e-5,0.306702 0.2486075,0.555342 0.55530986,0.55531 l 9.38843054,-0.01371 8.7608756,-0.0128 a 1.518967,1.518967 157.46848 0 0 1.071464,-0.444506 l 0.817962,-0.817371 1.705748,-1.704517 a 1.5143873,1.5143873 112.51034 0 0 0.44394,-1.07122 V 0.26847379 a 0.29590113,0.29590113 45 0 0 -0.295901,-0.29590113 z"
]
const Test = () => {
  const [pathIndex, setPathIndex] = useState(0);
  const progress = useMotionValue(pathIndex);
  const fill = useTransform(progress, paths.map(getIndex), colors);
  const path = useFlubber(progress, paths);
  useEffect(() => {
    const animation = animate(progress, pathIndex, {
      duration: 0.8,
      ease: "easeInOut",
      onComplete: () => {
        if (pathIndex === paths.length - 1) {
          progress.set(0);
          setPathIndex(1);
        } else {
          setPathIndex(pathIndex + 1);
        }
      }
    });

    return () => animation.stop();
  }, [pathIndex]);
  return (
    <div className="bg-slate-400 h-96 w-full relative py-7 ">
      <div className=" relative w-[14em] h-[14em] ">
      
      <svg width="400" height="400">
      <g transform="translate(10 10) scale(17 17)">
        <motion.path fill={fill} d={path} />
      </g>
    </svg>
      </div>
    </div>
  );
};

export default Test;
